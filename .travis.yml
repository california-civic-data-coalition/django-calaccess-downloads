language: python

sudo: false

cache:
  - pip

python:
 - "2.7"
 - "3.5"

env:
 - DJANGO_VERSION=1.9.7 db_name=calaccess_website db_user=postgres db_password='' rds_host=localhost
 - DJANGO_VERSION=1.10a1 db_name=calaccess_website db_user=postgres db_password='' rds_host=localhost

install:
 - pip install -r requirements.txt
 - pip uninstall -y Django
 - pip install -q Django==$DJANGO_VERSION

before_script:
  - psql -c 'create database calaccess_website;' -U postgres
  - fab setconfig:aws_access_key_id,
  - fab setconfig:aws_secret_access_key,
  - fab setconfig:aws_region_name,
  - fab setconfig:key_name,
  - fab setconfig:db_name,calaccess_website
  - fab setconfig:db_user,postgres
  - fab setconfig:db_password,
  - fab setconfig:s3_archived_data_bucket,
  - fab setconfig:s3_baked_content_bucket,
  - fab setconfig:email_user,
  - fab setconfig:email_password,
  - fab setconfig:rds_host,

script:
  - make test

after_success:
 - coveralls
