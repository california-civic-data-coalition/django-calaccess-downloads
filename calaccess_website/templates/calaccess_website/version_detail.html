{% extends 'calaccess_website/base.html' %}
{% load humanize calaccess_website_tags %}

{% block content %}
  <h3>CAL-ACCESS Release <br />
  {{ object.release_datetime|date:"l, N j, Y (P)" }}</h3>

  <h4><a href="{% archive_url object.zip_file_archive.name %}">original zip file</a> ({{ object.pretty_size }})</h4>

  {% if object.files.all %}

  {% regroup files|dictsort:"klass_group" by klass_group as model_groups %}
  {% for group in model_groups %}
    <h3>{{ group.grouper|capfirst }}</h3>
    <table class="table table-striped">
    <thead>
        <tr>
            <th>File name</th>
            <th class="right">Raw TSV</th>
            <th class="right">Clean CSV</th>
            <th class="right">Errors</th>
        </tr>
    </thead>
    <tbody>
    {% for file in group.list %}
        <tr>
            <td><a href="{% url 'rawdatafile_detail' file.file_name|slugify %}">{{ file.file_name }}</a></td>
            <td class="right">{{ file.download_records_count|intcomma }}  {% if file.download_file_archive %}<a href="{% archive_url file.download_file_archive.name %}"><i class="fa fa-download"></i></a>{% endif %}</td>
            <td class="right">{% if file.clean_file_archive %}{{ file.clean_records_count|intcomma }}  <a href="{% archive_url file.clean_file_archive.name %}"><i class="fa fa-download"></i></a>{% else %} -- {% endif %}</td>
            <td class="right">{% if file.error_log_archive %}{{ file.error_count|intcomma }}  <a href="{% archive_url file.error_log_archive.name %}"><i class="fa fa-download"></i></a>{% else%} -- {% endif %}</td>
        </tr>
    {% endfor %}
    </tbody>
    </table>
  {% endfor %}
  {% else %}
      <p>No files.</p>
  {% endif %}

{% endblock %}
